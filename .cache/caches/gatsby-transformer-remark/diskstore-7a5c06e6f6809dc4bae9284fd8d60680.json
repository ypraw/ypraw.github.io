{"expireTime":9007200829256307000,"key":"transformer-remark-markdown-html-088c4fe995e86bfe0290c1a5aaa90f18-gatsby-plugin-sharpgatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-emojis-","val":"<p>Yeay, Akhirnya Tutorial Dasar Flask memasuki tahap akhir. Yaitu tahap koneksi dengan database. Tutorial ini merupakan tutorial ketiga mengenai Flask dasar dan juga merupakan bagian kelima dari tutorial dasar Flask, yaitu <b>CRUD menggunakn raw query Mysql</b>. Sesuai dengan tujuan mengapa tutorial ini dibuat yaitu membuat <strong><em>The Real Apps On Flask</em></strong>, sebenernya sih bukan aplikasi beneran dengan segala macam kompleksitasnya hahaha, melainkan aplikasi yang mencakup Templating, Routing, viewing dan CRUD sebagai dasar pondasi Aplikasi yang kelak dibangun oleh pembaca masing-masing.</p>\n<!--more-->\n<p>Sebagai rangkuman, pada tutorial-tutorial sebelumnya kita telah mempelajari:</p>\n<table>\n<thead>\n<tr>\n<th>Tutorial</th>\n<th>Bagian</th>\n<th>Konten</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"/Tutorial-Flask-Framework\">Tutorial kesatu</a></td>\n<td>Kesatu</td>\n<td>Say Hello From Flask</td>\n</tr>\n<tr>\n<td><a href=\"/Tutorial-Flask-Framework\">Tutorial kesatu</a></td>\n<td>Kedua</td>\n<td>Templating</td>\n</tr>\n<tr>\n<td><a href=\"/Tutorial-Flask-Framework\">Tutorial kesatu</a></td>\n<td>Ketiga</td>\n<td>Routing dan Hyperlink</td>\n</tr>\n<tr>\n<td><a href=\"/Tutorial-Flask-Framework-Bagian-2\">Tutorial kedua</a></td>\n<td>Keempat</td>\n<td>The Real App on Flask</td>\n</tr>\n</tbody>\n</table>\n<h1>Memilih dan dipilih</h1>\n<p>Sub-judulnya kok agak gimana ya gitu :p, hahaha. Didalam Flask kita diperkenankan untuk menggunakan query langsung ataupun menggunakan ORM seperti SQL-Alchemy. Umumnya para penggiat flask menggunakan Sql-Alchemy sebagai pendamping Flask, ini dikarenakan\npenggunaan ORM lebih unggul dalam hal efisiensi kode dan tentunya adalah sekuritasnya. Ngomong-ngomong, udah tau ORM itu apa ? Singkatnya ORM adalah teknik untuk menghubungkan paradigma pemrograman OOP dan mengkonversi datanya dengan lingkungan database relasional atau dengan kata lain teknik penyimpanan data dalam bentuk objek. Untuk lebih jelasnya bisa <a href=\"https://en.wikipedia.org/wiki/Object-relational_mapping\">googling</a> sendiri wkwkwkwk.</p>\n<p>Pada Tutorial bagian kelima ini yang juga sebagai penutup keseluruhan tutorial dasar Flask, kita akan membuat Koneksi kedalam database menggunakan database MySql dengan metode raw query.</p>\n<p>Seperti biasa, dalam tiap tutorial baik template maupun views kita bedakan berdasarkan bagiannya dengan contoh penamaan untuk template bagian 1 namaTemplate1.html dan untuk Views nya views1.py dan begitu seterusnya.</p>\n<h1>Membuat Kelas Koneksi</h1>\n<p>Sebagai pengingat, Python dalam hal ini adalah bahasa pemrograman berbasis OOP yang juga mendukung koneksi terhadap database, jika belum tahu cara menghubungkan python dengan database, bisa dilihat <a href=\"/2017/06/08/Membuat-Koneksi-Database-pada-Python\">disini</a>, dan saya anggap pembaca telah mengerti cara membuat database.\nJika sudah taruhlah pada folder root aplikasi.</p>\n<h1>Membuat views (Controller)</h1>\n<p>Tentu seperti yang saya bahas pada awal tutorial ini, Aplikasi flask diatur oleh views, atau controller. Karena kita akan membuat aplikasi yang sedikit kompleks, views menjadi sangat vital untuk digunakan.</p>\n<p>Berikut ini merupakan views pada tutorial bagian kelima ini,</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#!flask/bin/python</span>\n\n<span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span> render_template<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> url_for<span class=\"token punctuation\">,</span> redirect<span class=\"token punctuation\">,</span> session\n<span class=\"token keyword\">import</span> connection <span class=\"token keyword\">as</span> db\n\napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">,</span> static_url_path<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n\nkonek <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span>MysqlUserDB<span class=\"token punctuation\">(</span><span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pos'</span><span class=\"token punctuation\">)</span>\ncur <span class=\"token operator\">=</span> konek<span class=\"token punctuation\">.</span>getDB<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'home5.html'</span><span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">'/login'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    error <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> validasi_login<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> konek<span class=\"token punctuation\">.</span>computeMD5hash<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            session<span class=\"token punctuation\">[</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'dashboard'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            error <span class=\"token operator\">=</span> <span class=\"token string\">\"incorrect password or username\"</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'login.html'</span><span class=\"token punctuation\">,</span> error<span class=\"token operator\">=</span>error<span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">'/logout'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    session<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">\"index\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">validasi_login</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from tb_user WHERE username=%s AND password=%s\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> cur<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">'/dashboard'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">dashboard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from product\"</span><span class=\"token punctuation\">)</span>\n        resultProduct <span class=\"token operator\">=</span> cur<span class=\"token punctuation\">.</span>fetchall<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'dashboard5.html'</span><span class=\"token punctuation\">,</span> resultProduct<span class=\"token operator\">=</span>resultProduct<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">'/product/add'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">add_product</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># cek apakah user sudah login, untuk mencegah akses data pada database</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">\"add_product5.html\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># ambil data dari form add product</span>\n        name <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span>\n        price <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">]</span>\n        stock <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"stock\"</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token comment\"># input ke database</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"INSERT INTO product values ((%s),(%s),(%s),(%s))\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">,</span> stock<span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># jika belum login maka diarahkan ke login page</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">'/product/update'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">update_product</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># cek apakah user sudah login, untuk mencegah akses data pada database</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        product_id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">:</span>\n            cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from product WHERE id = (%s)\"</span><span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span>\n            result <span class=\"token operator\">=</span> cur<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">\"edit_product5.html\"</span><span class=\"token punctuation\">,</span> result<span class=\"token operator\">=</span>result<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># ambil data dari form edit product</span>\n        name <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span>\n        price <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">]</span>\n        stock <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"stock\"</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token comment\"># Get , while rule reques method is POST</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"UPDATE product SET name= (%s), price= (%s), stock= (%s)\"</span>\n                    <span class=\"token string\">\"Where id= ( %s)\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">,</span> stock<span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># jika belum login maka diarahkan ke login page</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n@app<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">(</span><span class=\"token string\">\"/product/delete\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">product_delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"Delete product\"\"\"</span>\n    product_id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span>\n    cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from product WHERE id = (%s)\"</span><span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> cur<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># delete product by id</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"DELETE FROM product WHERE id =(%s)\"</span><span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">#   End Bagian kelima</span>\n<span class=\"token comment\"># if __name__ == '__main__':</span>\napp<span class=\"token punctuation\">.</span>debug <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\napp<span class=\"token punctuation\">.</span>secret_key <span class=\"token operator\">=</span> <span class=\"token string\">'4KuC1nT@K4MU'</span>\napp<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pada aplikasi ini, terdapat 5 bagian yaitu homepage, login-page, dashboard-page, edit-page, add-page. Selain homepage, 4 lainnya merupakan bagian pokok aplikasi Crud yang nantinya kita akan terapkan. Dan kesemuanya di atur pada views.</p>\n<h2>Method Login pada views5.py</h2>\n<p>Seperti pada tutorial <a href=\"/2017/06/06/Tutorial-Flask-Framework-Bagian-2\">sebelumnya</a> telah dijelaskan penggunaan session untuk login, pada tutorial kali ini source hanya di modifikasi agar menyesuaikan login dengan kelas koneksi yang kita buat.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/login'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    error <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> validasi_login<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> konek<span class=\"token punctuation\">.</span>computeMD5hash<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            session<span class=\"token punctuation\">[</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'dashboard'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            error <span class=\"token operator\">=</span> <span class=\"token string\">\"incorrect password or username\"</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'login.html'</span><span class=\"token punctuation\">,</span> error<span class=\"token operator\">=</span>error<span class=\"token punctuation\">)</span></code></pre></div>\n<p>pada syntax diatas, kita mengambil value dari form username dan value dari form password yang telah di rubah menjadi md5 (bisa dilihat di kelas koneksi untuk fungsi md5 nya).\nkemudian kita membuat session untuk username, jika matching antara username dan password pada database, maka kita mengarahkan ke halaman dashboar.</p>\n<h2>Method dashboard</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/dashboard'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">dashboard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from product\"</span><span class=\"token punctuation\">)</span>\n        resultProduct <span class=\"token operator\">=</span> cur<span class=\"token punctuation\">.</span>fetchall<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'dashboard5.html'</span><span class=\"token punctuation\">,</span> resultProduct<span class=\"token operator\">=</span>resultProduct<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pada method ini, pertama kali adalah mengecek session, hal ini untuk mencegah user yang belum login untuk mengakses halaman ini. Disini kita melakukan query untuk menampilkan semua produk dari database yang ditampilkan pada table di halaman ini.</p>\n<h2>Method add_product</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/product/add'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">add_product</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># cek apakah user sudah login, untuk mencegah akses data pada database</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">\"add_product5.html\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># ambil data dari form add product</span>\n        name <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span>\n        price <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">]</span>\n        stock <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"stock\"</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token comment\"># input ke database</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"INSERT INTO product values ((%s),(%s),(%s),(%s))\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">,</span> stock<span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># jika belum login maka diarahkan ke login page</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>pada method ini,kita juga melakukan pengecekan session, setelah itu, kita mengecek apakah ada request terhadap method get (dalam hal ini kita menggunakan method POST) karena itu kita akan melanjutkan ke syntax berikutnya, yaitu mengambil data dari form kemudian mengeksekusinya menggunakan Inser.</p>\n<h2>Method update_product</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/product/update'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">update_product</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># cek apakah user sudah login, untuk mencegah akses data pada database</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'username'</span> <span class=\"token keyword\">in</span> session<span class=\"token punctuation\">:</span>\n        product_id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">:</span>\n            cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from product WHERE id = (%s)\"</span><span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span>\n            result <span class=\"token operator\">=</span> cur<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">\"edit_product5.html\"</span><span class=\"token punctuation\">,</span> result<span class=\"token operator\">=</span>result<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># ambil data dari form edit product</span>\n        name <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span>\n        price <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">]</span>\n        stock <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"stock\"</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token comment\"># Get , while rule reques method is POST</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"UPDATE product SET name= (%s), price= (%s), stock= (%s)\"</span>\n                    <span class=\"token string\">\"Where id= ( %s)\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">,</span> stock<span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># jika belum login maka diarahkan ke login page</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pada method ini pertama kali yang kita lakukan adalah mengambil argumen id pada url (perhatikan url pada template dashboard bagian edit) disini saya mengambil id berdasarkan item yang di klik oleh user, kemudian kita melakukan query untuk mengisikan form pada halaman edit_product5.html guna menampilkan status info saat ini yang akan di edit oleh user.\nsetelah ditampilkan, langkahnya hampir sama dengan method add, kita mengambil variabel dar form (dalam hal ini adalah yang sudah diedit) kemudian kita mengeksekusinya kedalam database.</p>\n<h2>Method product_delete</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/product/delete\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">product_delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"Delete product\"\"\"</span>\n    product_id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span>\n    cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * from product WHERE id = (%s)\"</span><span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> cur<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># delete product by id</span>\n        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"DELETE FROM product WHERE id =(%s)\"</span><span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">\"/dashboard\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>pada method ini kita mengambil id pada url, kemudian kita melakukan query. Jika query berhasil dilakukan maka kita akan mendelete berdasarkan product id yang kita ambil sebelumnya.</p>\n<h1>Template</h1>\n<p>Sebenernya template pada template yang saya buat, tidak banyak koding dari Flask itu sendiri, lebih kepada markup html dan bootstrap. tapi sebagai formalitas wkwkwk, saya juga akan menjelaskan beberapa bagian pada template yang dibagun.</p>\n<h2>Template dashboard</h2>\n<p>Pada template dashboard terdapat syntax</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">{% for item in resultProduct %}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>\n        {{ item[0] }}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>\n        {{ item[1] }}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>\n        {{ item[2] }}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>\n        {{ item[3] }}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/product/update?id={{ item[0] }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>edit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/product/delete?id={{ item[0] }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>delete<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n{% endfor %}</code></pre></div>\n<p>Syntax diatas merupakan syntax hasil query (lihat views dashboard) yang saya return menggunakan nama resultProduct. Setelah kita mereturn (dalam hal ini resultnya masih berupa tuple) sehingga kita harus memecah value nya menggunakan looping. Untuk memanggil valuenya kita menggunakan pemanggilan index.\npada hyperlink edit dan delete, url yang akan dipanggil di kerucutkan berdasarkan id produk yang di klik oleh user yang berada pada index ke 0 (lihat susunan database, id berada pada kolom paling kiri yang artinya berada pada index 0 jika direpresenasikan kedalam tuple).</p>\n<p>untuk template-template lainnya juga sama, semua looping ataupun pemanggilan paramater didala template merupakan hasil return render_template dari method-method terkait pada views.</p>\n<h1>ScreenShoot</h1>\n<h2>Halaman Depan</h2>\n<img src=\"https://res.cloudinary.com/ypraw/image/upload/v1497044623/flask3-1_ptlvs0.png\" width=\"100%\" height=\"auto\">\n<h2>Halaman login</h2>\n<img src=\"https://res.cloudinary.com/ypraw/image/upload/v1497044747/flask3-2_qmjqh7.png\" width=\"100%\" height=\"auto\">\n<h2>Halaman Dasboard</h2>\n<img src=\"https://res.cloudinary.com/ypraw/image/upload/v1497044741/flask3-3_z3ejfe.png\" width=\"100%\" height=\"auto\">\n<h2>Halaman Add product</h2>\n<img src=\"https://res.cloudinary.com/ypraw/image/upload/v1497044743/flask3-4_jzqmeg.png\" width=\"100%\" height=\"auto\">\n<h2>Halaman Update Product</h2>\n<img src=\"https://res.cloudinary.com/ypraw/image/upload/v1497044743/flask3-5_hckvs5.png\" width=\"100%\" height=\"auto\">\n<h1>Penutup</h1>\n<p>Alhamdulillah akhirnya tutorial akhir Dasar Flask telah berakhir, semoga dengan tutorial akhir ini para pemabaca dapat memahami apa itu FLask dan fungsi-fungsi dasar dalam membangun aplikasi web berbasis python dengan Framework flask.\nUntuk tutorial selanjutnya saya akan menjelaskan mengenai Flask dengan ORM SQL-Alchemy</p>\n<p>Untuk Source Code keselurahan tutorial ini dapat di download dari github <a href=\"https://github.com/ypraw/Tutorial-Flask/tree/master/webFlask\">saya</a></p>"}