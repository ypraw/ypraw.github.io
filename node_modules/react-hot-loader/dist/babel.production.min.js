"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var RHLPackage="react-hot-loader",RHLRootPackage="react-hot-loader/root",RHLPackages=[RHLPackage,RHLRootPackage];function isImportedFromRHL(e,a){var t=e.scope.getBinding(a),r=t&&t.path.node.type;if("ImportSpecifier"===r||"ImportNamespaceSpecifier"===r){var n=t.path.parent;return RHLPackages.includes(n.source.value)}return!1}function getRHLContext(e){for(var a=[],t=e.ast.program.body,r=0;r<t.length;r++){var n=t[r],l=n.source,o=n.specifiers;if("ImportDeclaration"===n.type&&RHLPackages.includes(l.value))for(var i=0;i<o.length;i++){var c=o[i];if("ImportNamespaceSpecifier"===c.type)a.push({kind:"namespace",local:c.local.name});else if("ImportSpecifier"===c.type){var p={kind:"named",local:c.local.name};"hot"===c.imported.name&&a.push(p)}}}return a.length?a:null}function plugin(){return{pre:function(){this.rhlContext=getRHLContext(this.file),this.rhlContext||(this.cancel=!0)},visitor:{CallExpression:function(e){if(!this.cancel)for(var a=0;a<this.rhlContext.length;a++){var t=this.rhlContext[a];if("named"===t.kind){if(e.node.callee.name===t.local&&isImportedFromRHL(e,t.local)&&"CallExpression"===e.parent.type&&e.parent.arguments[0]&&"Identifier"===e.parent.arguments[0].type){e.parentPath.replaceWith(e.parent.arguments[0]);break}if(e.node.callee.name===t.local&&isImportedFromRHL(e,t.local)&&"CallExpression"===e.type&&e.node.arguments[0]&&"Identifier"===e.node.arguments[0].type){e.replaceWith(e.node.arguments[0]);break}}else if("namespace"===t.kind&&e.node.callee.callee&&"MemberExpression"===e.node.callee.callee.type&&"Identifier"===e.node.callee.callee.object.type&&e.node.callee.callee.object.name===t.local&&isImportedFromRHL(e,t.local)&&"Identifier"===e.node.callee.callee.property.type&&"hot"===e.node.callee.callee.property.name&&e.node.arguments[0]&&"Identifier"===e.node.arguments[0].type){e.replaceWith(e.node.arguments[0]);break}}}}}}exports.default=plugin;
