{"version":3,"sources":["../src/Profile.jsx"],"names":["Profile","Component","loading","api","updateProfile","props","fields","response","getLoginStatus","status","LoginStatus","CONNECTED","setState","profile","undefined","error","getProfile","render","children","state","handleReady","handleStatusChange","Fields"],"mappings":";;;;;;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AAae,MAAMA,OAAN,SAAsBC,gBAAtB,CAA8C;AAAA;AAAA;;AAAA;AAAA;AAAA,iDAK5C;AACbC,MAAAA,OAAO,EAAE;AADI,KAL4C;AAAA;AAAA;AAAA;AAAA,iDAS7C,WAAOC,GAAP,EAAsC;AAClD,QAAA,KAAI,CAACA,GAAL,GAAWA,GAAX;;AAEA,QAAA,KAAI,CAACC,aAAL;AACD,OAb0D;;AAAA;AAAA;AAAA;AAAA;AAAA,8DAetC,MAAY;AAC/B,WAAKA,aAAL;AACD,KAjB0D;AAAA;;AAmBrDA,EAAAA,aAAN,GAAsB;AAAA;;AAAA;AACpB,YAAM;AAAED,QAAAA,GAAF;AAAOE,QAAAA,KAAK,EAAE;AAAEC,UAAAA;AAAF;AAAd,UAA6B,MAAnC;;AACA,UAAI,CAACH,GAAL,EAAU;AACR;AACD;;AAED,UAAI;AACF,cAAMI,QAAQ,SAASJ,GAAG,CAACK,cAAJ,EAAvB;;AACA,YAAID,QAAQ,CAACE,MAAT,KAAoBC,qBAAYC,SAApC,EAA+C;AAC7C,UAAA,MAAI,CAACC,QAAL,CAAc;AACZC,YAAAA,OAAO,EAAEC,SADG;AAEZZ,YAAAA,OAAO,EAAE,KAFG;AAGZa,YAAAA,KAAK,EAAED;AAHK,WAAd;;AAMA;AACD;;AAED,cAAMD,OAAO,SAASV,GAAG,CAACa,UAAJ,CAAe;AACnCV,UAAAA;AADmC,SAAf,CAAtB;;AAIA,QAAA,MAAI,CAACM,QAAL,CAAc;AACZC,UAAAA,OADY;AAEZX,UAAAA,OAAO,EAAE,KAFG;AAGZa,UAAAA,KAAK,EAAED;AAHK,SAAd;AAKD,OArBD,CAqBE,OAAOC,KAAP,EAAc;AACd,QAAA,MAAI,CAACH,QAAL,CAAc;AACZC,UAAAA,OAAO,EAAEC,SADG;AAEZZ,UAAAA,OAAO,EAAE,KAFG;AAGZa,UAAAA;AAHY,SAAd;AAKD;AAjCmB;AAkCrB;;AAEDE,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA;AAAF,QAAe,KAAKb,KAA1B;AACA,UAAM;AAAEQ,MAAAA,OAAF;AAAWX,MAAAA,OAAX;AAAoBa,MAAAA;AAApB,QAA8B,KAAKI,KAAzC;AAEA,WACE,6BAAC,mBAAD;AAAY,MAAA,OAAO,EAAE,KAAKC;AAA1B,OACE,6BAAC,kBAAD;AAAW,MAAA,KAAK,EAAC,mBAAjB;AAAqC,MAAA,QAAQ,EAAE,KAAKC;AAApD,OACGH,QAAQ,CAAC;AACRL,MAAAA,OADQ;AAERX,MAAAA,OAFQ;AAGRa,MAAAA;AAHQ,KAAD,CADX,CADF,CADF;AAWD;;AAtE0D;;;8BAAxCf,O,kBACG;AACpBM,EAAAA,MAAM,EAAEgB;AADY,C","sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport Initialize from './Initialize';\nimport Subscribe from './Subscribe';\nimport Fields from './constants/Fields';\nimport LoginStatus from './constants/LoginStatus';\n\ntype Props = {\n  children: Function,\n  fields?: string[],\n};\n\ntype State = {\n  loading: Boolean,\n  profile?: Object,\n  error?: Error,\n};\n\nexport default class Profile extends Component<Props, State> {\n  static defaultProps = {\n    fields: Fields,\n  };\n\n  state: State = {\n    loading: true,\n  };\n\n  handleReady = async (api: Object): Promise<void> => {\n    this.api = api;\n\n    this.updateProfile();\n  }\n\n  handleStatusChange = (): void => {\n    this.updateProfile();\n  }\n\n  async updateProfile() {\n    const { api, props: { fields } } = this;\n    if (!api) {\n      return;\n    }\n\n    try {\n      const response = await api.getLoginStatus();\n      if (response.status !== LoginStatus.CONNECTED) {\n        this.setState({\n          profile: undefined,\n          loading: false,\n          error: undefined,\n        });\n\n        return;\n      }\n\n      const profile = await api.getProfile({\n        fields,\n      });\n\n      this.setState({\n        profile,\n        loading: false,\n        error: undefined,\n      });\n    } catch (error) {\n      this.setState({\n        profile: undefined,\n        loading: false,\n        error,\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const { profile, loading, error } = this.state;\n\n    return (\n      <Initialize onReady={this.handleReady}>\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\n          {children({\n            profile,\n            loading,\n            error,\n          })}\n        </Subscribe>\n      </Initialize>\n    );\n  }\n}\n"],"file":"Profile.js"}