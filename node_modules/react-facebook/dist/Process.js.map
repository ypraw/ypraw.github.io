{"version":3,"sources":["../src/Process.jsx"],"names":["Process","state","isWorking","isMounted","handleClick","evn","preventDefault","stopPropagation","setState","facebook","Error","dontWait","onResponse","onError","props","process","then","response","error","e","handleFacebookReady","onReady","componentWillUnmount","getElement","children","render","component","CustomComponent","isLoading","isReady","onClick","defaultProps","undefined"],"mappings":"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","file":"Process.js","sourcesContent":["// @flow\nimport type { Node } from 'react';\nimport React, { Component, cloneElement } from 'react';\nimport InitFacebook from './InitFacebook';\n\ntype Props = {\n  children?: Node,\n  render?: Function,\n  component?: Node,\n  onReady?: Function,\n  onError?: Function,\n  onResponse?: Function,\n  dontWait?: boolean,\n};\n\ntype State = {\n  isMounted: boolean,\n};\n\nexport default class Process extends Component<Props, State> {\n  static defaultProps = {\n    children: undefined,\n    render: undefined,\n    component: undefined,\n    onReady: undefined,\n    onError: undefined,\n    onResponse: undefined,\n    dontWait: undefined,\n  };\n\n  state: State = {\n    isWorking: false,\n    isMounted: true,\n  };\n\n  componentWillUnmount() {\n    this.setState({\n      isMounted: false,\n    });\n  }\n\n  getElement() {\n    const {\n      children,\n      render,\n      component: CustomComponent,\n    } = this.props;\n\n    const { facebook, isWorking } = this.state;\n    const isLoading = !facebook;\n    const isReady = !isLoading && !isWorking;\n\n    if (render) {\n      return render({\n        isWorking,\n        isLoading,\n        isReady,\n        onClick: this.handleClick,\n      });\n    }\n\n    if (CustomComponent) {\n      return (\n        <CustomComponent\n          onClick={this.handleClick}\n          isLoading={isLoading}\n          isWorking={isWorking}\n          isReady={isReady}\n        />\n      );\n    }\n\n    return cloneElement(children, {\n      onClick: this.handleClick,\n    });\n  }\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n    evn.stopPropagation();\n\n    this.setState({\n      isWorking: true,\n    });\n\n    try {\n      const { facebook } = this.state;\n      if (!facebook) {\n        throw new Error('Facebook is not initialized');\n      }\n\n      const { dontWait, onResponse, onError } = this.props;\n      if (dontWait) {\n        this.process(facebook).then((response) => {\n          if (onResponse) {\n            onResponse(response);\n          }\n        }, (error) => {\n          if (onError) {\n            onError(error);\n          }\n        });\n      } else {\n        const response = await this.process(facebook);\n\n        if (onResponse) {\n          await onResponse(response);\n        }\n      }\n    } catch (e) {\n      const { onError } = this.props;\n      if (onError) {\n        await onError(e);\n      }\n    }\n\n    const { isMounted } = this.state;\n    if (isMounted) {\n      this.setState({\n        isWorking: false,\n      });\n    }\n  }\n\n  handleFacebookReady = (facebook) => {\n    const { isMounted } = this.state;\n    if (isMounted) {\n      this.setState({ facebook });\n\n      const { onReady } = this.props;\n      if (onReady) {\n        onReady(facebook);\n      }\n    }\n  }\n\n  render() {\n    return (\n      <InitFacebook onReady={this.handleFacebookReady}>\n        {this.getElement()}\n      </InitFacebook>\n    );\n  }\n}\n"]}