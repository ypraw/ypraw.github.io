{"version":3,"sources":["../src/Process.jsx"],"names":["Process","state","isWorking","isMounted","handleClick","evn","preventDefault","stopPropagation","setState","facebook","Error","props","dontWait","onResponse","onError","process","then","response","error","handleFacebookReady","onReady","componentWillUnmount","getElement","children","render","CustomComponent","component","isLoading","isReady","onClick","defaultProps","undefined"],"mappings":"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","file":"Process.js","sourcesContent":["// @flow\nimport type { Node } from 'react';\nimport React, { Component, cloneElement } from 'react';\nimport InitFacebook from './InitFacebook';\n\ntype Props = {\n  children?: Node,\n  render?: Function,\n  component?: Node,\n  onReady?: Function,\n  onError?: Function,\n  onResponse?: Function,\n  dontWait?: boolean,\n};\n\ntype State = {\n  isMounted: boolean,\n};\n\nexport default class Process extends Component<Props, State> {\n  static defaultProps = {\n    children: undefined,\n    render: undefined,\n    component: undefined,\n    onReady: undefined,\n    onError: undefined,\n    onResponse: undefined,\n    dontWait: undefined,\n  };\n\n  state: State = {\n    isWorking: false,\n    isMounted: true,\n  };\n\n  componentWillUnmount() {\n    this.setState({\n      isMounted: false,\n    });\n  }\n\n  getElement() {\n    const {\n      children,\n      render,\n      component: CustomComponent,\n    } = this.props;\n\n    const { facebook, isWorking } = this.state;\n    const isLoading = !facebook;\n    const isReady = !isLoading && !isWorking;\n\n    if (render) {\n      return render({\n        isWorking,\n        isLoading,\n        isReady,\n        onClick: this.handleClick,\n      });\n    }\n\n    if (CustomComponent) {\n      return (\n        <CustomComponent\n          onClick={this.handleClick}\n          isLoading={isLoading}\n          isWorking={isWorking}\n          isReady={isReady}\n        />\n      );\n    }\n\n    return cloneElement(children, {\n      onClick: this.handleClick,\n    });\n  }\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n    evn.stopPropagation();\n\n    this.setState({\n      isWorking: true,\n    });\n\n    try {\n      const { facebook } = this.state;\n      if (!facebook) {\n        throw new Error('Facebook is not initialized');\n      }\n\n      const { dontWait, onResponse, onError } = this.props;\n      if (dontWait) {\n        this.process(facebook).then((response) => {\n          if (onResponse) {\n            onResponse(response);\n          }\n        }, (error) => {\n          if (onError) {\n            onError(error);\n          }\n        });\n      } else {\n        const response = await this.process(facebook);\n\n        if (onResponse) {\n          await onResponse(response);\n        }\n      }\n    } catch (e) {\n      const { onError } = this.props;\n      if (onError) {\n        await onError(e);\n      }\n    }\n\n    const { isMounted } = this.state;\n    if (isMounted) {\n      this.setState({\n        isWorking: false,\n      });\n    }\n  }\n\n  handleFacebookReady = (facebook) => {\n    const { isMounted } = this.state;\n    if (isMounted) {\n      this.setState({ facebook });\n\n      const { onReady } = this.props;\n      if (onReady) {\n        onReady(facebook);\n      }\n    }\n  }\n\n  render() {\n    return (\n      <InitFacebook onReady={this.handleFacebookReady}>\n        {this.getElement()}\n      </InitFacebook>\n    );\n  }\n}\n"]}