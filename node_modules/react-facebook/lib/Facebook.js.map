{"version":3,"sources":["../src/Facebook.js"],"names":["Method","GET","POST","DELETE","Facebook","options","domain","version","cookie","status","xfbml","language","frictionlessRequests","debug","chatSupport","appId","Error","wait","init","getAppId","loadingPromise","Promise","resolve","restOptions","window","fbAsyncInit","FB","document","getElementById","js","createElement","id","async","defer","src","body","appendChild","process","method","before","after","fb","reject","response","error","code","type","message","ui","api","path","params","login","opts","logout","getLoginStatus","getAuthResponse","getTokenDetail","loginResponse","LoginStatus","CONNECTED","authResponse","getProfile","getTokenDetailWithProfile","tokenDetail","profile","getToken","accessToken","getUserId","userID","sendInvite","to","postAction","ogNamespace","ogAction","ogObject","ogObjectUrl","noFeedStory","url","encodeURIComponent","getPermissions","data","hasPermissions","permissions","usersPermissions","findedPermissions","filter","p","currentPermission","find","row","permission","length","subscribe","eventName","callback","Event","unsubscribe","parse","parentNode","XFBML","getRequests","removeRequest","requestID","setAutoGrow","Canvas","paySimple","product","quantity","action","pay"],"mappings":"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","sourcesContent":["// @flow\nimport LoginStatus from './constants/LoginStatus';\n\nexport const Method = {\n  GET: 'get',\n  POST: 'post',\n  DELETE: 'delete',\n};\n\nexport default class Facebook {\n  constructor(options = {}) {\n    this.options = {\n      domain: 'connect.facebook.net',\n      version: 'v3.2',\n      cookie: false,\n      status: false,\n      xfbml: false,\n      language: 'en_US',\n      frictionlessRequests: false,\n      debug: false,\n      chatSupport: false,\n      ...options,\n    };\n\n    if (!this.options.appId) {\n      throw new Error('You need to set appId');\n    }\n\n    if (!this.options.wait) {\n      this.init();\n    }\n  }\n\n  getAppId(): string {\n    return this.options.appId;\n  }\n\n  async init() {\n    if (this.loadingPromise) {\n      return this.loadingPromise;\n    }\n\n    this.loadingPromise = new Promise((resolve) => {\n      const {\n        domain,\n        language,\n        debug,\n        chatSupport,\n        ...restOptions\n      } = this.options;\n\n      window.fbAsyncInit = () => {\n        window.FB.init({\n          appId: restOptions.appId,\n          version: restOptions.version,\n          cookie: restOptions.cookie,\n          status: restOptions.status,\n          xfbml: restOptions.xfbml,\n          frictionlessRequests: this.frictionlessRequests,\n        });\n\n        resolve(window.FB);\n      };\n\n      if (window.document.getElementById('facebook-jssdk')) {\n        return resolve(window.FB);\n      }\n\n      const js = window.document.createElement('script');\n      js.id = 'facebook-jssdk';\n      js.async = true;\n      js.defer = true;\n      js.src = `https://${domain}/${language}/sdk${chatSupport ? '/xfbml.customerchat' : ''}${debug ? '/debug' : ''}.js`;\n\n      window.document.body.appendChild(js);\n    });\n\n    return this.loadingPromise;\n  }\n\n  async process(method, before = [], after = []) {\n    const fb = await this.init();\n\n    return new Promise((resolve, reject) => {\n      fb[method](...before, (response) => {\n        if (!response) {\n          if (method === 'ui') return;\n          reject(new Error('Response is undefined'));\n        } else if (response.error) {\n          const { code, type, message } = response.error;\n\n          const error = new Error(message);\n          error.code = code;\n          error.type = type;\n\n          reject(error);\n        } else {\n          resolve(response);\n        }\n      }, ...after);\n    });\n  }\n\n  async ui(options) {\n    return this.process('ui', [options]);\n  }\n\n  async api(path, method = Method.GET, params = {}) {\n    return this.process('api', [path, method, params]);\n  }\n\n  async login(opts = null) {\n    return this.process('login', [], [opts]);\n  }\n\n  async logout() {\n    return this.process('logout');\n  }\n\n  async getLoginStatus() {\n    return this.process('getLoginStatus');\n  }\n\n  async getAuthResponse() {\n    return this.process('getAuthResponse');\n  }\n\n  async getTokenDetail(loginResponse) {\n    if (loginResponse.status === LoginStatus.CONNECTED && loginResponse.authResponse) {\n      return loginResponse.authResponse;\n    }\n\n    const response = await this.getLoginStatus();\n\n    if (response.status === LoginStatus.CONNECTED && response.authResponse) {\n      return response.authResponse;\n    }\n\n    throw new Error('Token is undefined');\n  }\n\n  async getProfile(params) {\n    return this.api('/me', Method.GET, params);\n  }\n\n  async getTokenDetailWithProfile(params, response) {\n    const tokenDetail = await this.getTokenDetail(response);\n    const profile = await this.getProfile(params);\n\n    return {\n      profile,\n      tokenDetail,\n    };\n  }\n\n  async getToken() {\n    const authResponse = await this.getTokenDetail();\n    return authResponse.accessToken;\n  }\n\n  async getUserId() {\n    const authResponse = await this.getTokenDetail();\n    return authResponse.userID;\n  }\n\n  async sendInvite(to, options) {\n    return this.ui({\n      to,\n      method: 'apprequests',\n      ...options,\n    });\n  }\n\n\n  async postAction(ogNamespace, ogAction, ogObject, ogObjectUrl, noFeedStory) {\n    let url = `/me/${ogNamespace}:${ogAction}?${ogObject}=${encodeURIComponent(ogObjectUrl)}`;\n\n    if (noFeedStory === true) {\n      url += '&no_feed_story=true';\n    }\n\n    return this.api(url, Method.POST);\n  }\n\n  async getPermissions() {\n    const response = await this.api('/me/permissions');\n    return response.data;\n  }\n\n  async hasPermissions(permissions) {\n    const usersPermissions = await this.getPermissions();\n\n    const findedPermissions = permissions.filter((p) => {\n      const currentPermission = usersPermissions.find((row) => {\n        const { permission, status } = row;\n        return status === 'granted' && permission === p;\n      });\n\n      return !!currentPermission;\n    });\n\n    return findedPermissions.length === permissions.length;\n  }\n\n  async subscribe(eventName, callback) {\n    const fb = await this.init();\n    fb.Event.subscribe(eventName, callback);\n  }\n\n  async unsubscribe(eventName, callback) {\n    const fb = await this.init();\n    fb.Event.unsubscribe(eventName, callback);\n  }\n\n  async parse(parentNode) {\n    const fb = await this.init();\n\n    if (typeof parentNode === 'undefined') {\n      fb.XFBML.parse();\n    } else {\n      fb.XFBML.parse(parentNode);\n    }\n  }\n\n  async getRequests() {\n    return this.api('/me/apprequests');\n  }\n\n  async removeRequest(requestID) {\n    return this.api(requestID, Method.DELETE);\n  }\n\n  async setAutoGrow() {\n    const fb = await this.init();\n    fb.Canvas.setAutoGrow();\n  }\n\n  async paySimple(product, quantity = 1) {\n    return this.ui({\n      method: 'pay',\n      action: 'purchaseitem',\n      product,\n      quantity,\n    });\n  }\n\n  async pay(product, options) {\n    return this.ui({\n      method: 'pay',\n      action: 'purchaseitem',\n      product,\n      ...options,\n    });\n  }\n}\n\n/*\n  sendToFriends: function(options, callback) {\n    if(!options) {\n      options = {};\n    }\n\n    options.method = 'send';\n\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.ui(options, function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  sendMessage: function(message, name, caption, description, url, imgUrl, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.ui({\n        method: 'stream.publish',\n        message: message,\n        attachment: {\n          name: name,\n          caption: caption,\n          description: description,\n          href: url,\n          media:[{\n            type: 'image',\n            src:  imgUrl,\n            href: url\n          }]\n        },\n        action_links: [{\n          text: 'Code',\n          href: url\n        }],\n        user_prompt_message: message\n      },\n      function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  sendInviteForm: function(options, callback) {\n    if(typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      options.method = options.method || 'apprequests';\n\n\n      FB.ui(options, function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  checkPageLike: function(pageID, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      fbApi.getUserID(function(err, userID) {\n        if(err) {\n          return callback(err);\n        }\n\n        var fqlQuery = `SELECT uid FROM page_fan WHERE page_id = ${pageID} and uid = ${userID}`;\n        var query = FB.Data.query(fqlQuery);\n\n        query.wait(function(rows) {\n          if (rows.length === 1 && rows[0].uid === userID) {\n            callback(null, true, query);\n          }\n          else {\n            callback(null, false, query);\n          }\n        });\n      });\n    });\n  },\n\n  sendMessageToFriend: function (friendID, link, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.ui({\n        to: friendID,\n        method: 'send',\n        link: link\n      }, function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  _prepareUsers: function(data) {\n    var users=[];\n\n    for(var index in data) {\n      var userData=data[index];\n\n      var user = {\n        provider_uid: 'facebook'+'_'+userData.uid,\n        provider: 'facebook',\n        id: userData.uid,\n        name: userData.name,\n        first_name: userData.first_name,\n        last_name: userData.last_name,\n        status: (userData.status!==null) ? userData.status : null,\n        image: '//graph.facebook.com/'+userData.uid+'/picture?'\n      };\n\n      users.push(user);\n    }\n\n    return users;\n  },\n\n  getUserList: function(callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('fql', {\n        q: `\n          SELECT uid, name, first_name, last_name, online_presence, status\n          FROM user\n          WHERE uid IN\n            ( SELECT uid2 FROM friend WHERE uid1 = me()) ORDER BY name\n        `,\n      }, function (response)\n      {\n        var users = fbApi._prepareUsers(response.data);\n        callback(null, users, response);\n      });\n    });\n  },\n\n  postFeed: function(options, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      options.method='feed';\n\n      FB.ui(options, function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  //need publish_stream\n  createAlbum: function(name, description, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('/me/albums', 'post', {\n        name: name,\n        description: description\n      },function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  //need publish_stream\n  addImageToAlbum: function(albumID, imageURL, message, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('/'+albumID+'/photos', 'post', {\n        message: message,\n        url: imageURL\n      }, function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  //'user_photos'\n  getAlbums: function(callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('/me/albums', function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  //'user_photos'\n  getAlbumPhotos: function(albumID, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('/'+albumID+'/photos', function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  //'user_photos'\n  getAlbumCoverPicture: function(albumID, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('/'+albumID+'/picture', function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  //'publish_stream'\n  postPhoto: function(photoUrl, message, callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.api('/me/photos', 'post', {\n        message: message,\n        url: photoUrl\n      },function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  },\n\n  getPageInfo: function(callback) {\n    this.afterLoad(function(err, fbApi) {\n      if(err) {\n        return callback(err);\n      }\n\n      FB.Canvas.getPageInfo(function(response) {\n        fbApi._callCallbackByResponse(callback, response);\n      });\n    });\n  }\n*/\n"],"file":"Facebook.js"}