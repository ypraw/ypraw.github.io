{"version":3,"sources":["../src/Profile.jsx"],"names":["Profile","loading","api","updateProfile","fields","props","getLoginStatus","response","status","LoginStatus","CONNECTED","setState","profile","undefined","error","getProfile","render","children","state","handleReady","handleStatusChange","Component","Fields"],"mappings":";;;;;;;;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;IAaqBA,O;;;;;;;;;;;;;wFAKJ;AACbC,MAAAA,OAAO,EAAE;AADI,K;8FAID,iBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AACZ,oBAAKA,GAAL,GAAWA,GAAX;;AAEA,oBAAKC,aAAL;;AAHY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;qGAMO,YAAY;AAC/B,YAAKA,aAAL;AACD,K;;;;;;SAEKA,a,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACUD,YAAAA,GADV,GACqC,IADrC,CACUA,GADV,EACwBE,MADxB,GACqC,IADrC,CACeC,KADf,CACwBD,MADxB;;AAAA,gBAEOF,GAFP;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,8CAO2BA,GAAG,CAACI,cAAJ,EAP3B;;AAAA;AAOUC,YAAAA,QAPV;;AAAA,kBAQQA,QAAQ,CAACC,MAAT,KAAoBC,qBAAYC,SARxC;AAAA;AAAA;AAAA;;AASM,iBAAKC,QAAL,CAAc;AACZC,cAAAA,OAAO,EAAEC,SADG;AAEZZ,cAAAA,OAAO,EAAE,KAFG;AAGZa,cAAAA,KAAK,EAAED;AAHK,aAAd;AATN;;AAAA;AAAA;AAAA,8CAkB0BX,GAAG,CAACa,UAAJ,CAAe;AACnCX,cAAAA,MAAM,EAANA;AADmC,aAAf,CAlB1B;;AAAA;AAkBUQ,YAAAA,OAlBV;AAsBI,iBAAKD,QAAL,CAAc;AACZC,cAAAA,OAAO,EAAPA,OADY;AAEZX,cAAAA,OAAO,EAAE,KAFG;AAGZa,cAAAA,KAAK,EAAED;AAHK,aAAd;AAtBJ;AAAA;;AAAA;AAAA;AAAA;AA4BI,iBAAKF,QAAL,CAAc;AACZC,cAAAA,OAAO,EAAEC,SADG;AAEZZ,cAAAA,OAAO,EAAE,KAFG;AAGZa,cAAAA,KAAK;AAHO,aAAd;;AA5BJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;SAoCAE,M,GAAA,kBAAS;AAAA,QACCC,QADD,GACc,KAAKZ,KADnB,CACCY,QADD;AAAA,sBAE6B,KAAKC,KAFlC;AAAA,QAECN,OAFD,eAECA,OAFD;AAAA,QAEUX,OAFV,eAEUA,OAFV;AAAA,QAEmBa,KAFnB,eAEmBA,KAFnB;AAIP,WACE,6BAAC,mBAAD;AAAY,MAAA,OAAO,EAAE,KAAKK;AAA1B,OACE,6BAAC,kBAAD;AAAW,MAAA,KAAK,EAAC,mBAAjB;AAAqC,MAAA,QAAQ,EAAE,KAAKC;AAApD,OACGH,QAAQ,CAAC;AACRL,MAAAA,OAAO,EAAPA,OADQ;AAERX,MAAAA,OAAO,EAAPA,OAFQ;AAGRa,MAAAA,KAAK,EAALA;AAHQ,KAAD,CADX,CADF,CADF;AAWD,G;;;EAtEkCO,gB;;;8BAAhBrB,O,kBACG;AACpBI,EAAAA,MAAM,EAAEkB;AADY,C","sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport Initialize from './Initialize';\nimport Subscribe from './Subscribe';\nimport Fields from './constants/Fields';\nimport LoginStatus from './constants/LoginStatus';\n\ntype Props = {\n  children: Function,\n  fields?: string[],\n};\n\ntype State = {\n  loading: Boolean,\n  profile?: Object,\n  error?: Error,\n};\n\nexport default class Profile extends Component<Props, State> {\n  static defaultProps = {\n    fields: Fields,\n  };\n\n  state: State = {\n    loading: true,\n  };\n\n  handleReady = async (api: Object): Promise<void> => {\n    this.api = api;\n\n    this.updateProfile();\n  }\n\n  handleStatusChange = (): void => {\n    this.updateProfile();\n  }\n\n  async updateProfile() {\n    const { api, props: { fields } } = this;\n    if (!api) {\n      return;\n    }\n\n    try {\n      const response = await api.getLoginStatus();\n      if (response.status !== LoginStatus.CONNECTED) {\n        this.setState({\n          profile: undefined,\n          loading: false,\n          error: undefined,\n        });\n\n        return;\n      }\n\n      const profile = await api.getProfile({\n        fields,\n      });\n\n      this.setState({\n        profile,\n        loading: false,\n        error: undefined,\n      });\n    } catch (error) {\n      this.setState({\n        profile: undefined,\n        loading: false,\n        error,\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const { profile, loading, error } = this.state;\n\n    return (\n      <Initialize onReady={this.handleReady}>\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\n          {children({\n            profile,\n            loading,\n            error,\n          })}\n        </Subscribe>\n      </Initialize>\n    );\n  }\n}\n"],"file":"Profile.js"}