{"version":3,"sources":["../src/Login.jsx"],"names":["Login","evn","preventDefault","props","handleProcess","onCompleted","onError","onSuccess","api","scope","fields","returnScopes","rerequest","reauthorize","eventKey","loginQpts","authType","return_scopes","push","length","auth_type","join","login","loginResponse","status","Error","getTokenDetailWithProfile","data","render","children","loading","error","handleClick","Component","Fields","undefined","ref"],"mappings":"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","sourcesContent":["// @flow\nimport React, { Component, forwardRef } from 'react';\nimport Process from './Process';\nimport Fields from './constants/Fields';\n\ntype Props = {\n  children: Function,\n  handleProcess: Function,\n  loading: boolean,\n  data: any,\n  error: Error,\n  scope?: string,\n  fields?: string[],\n  returnScopes?: boolean,\n  rerequest?: boolean,\n  reauthorize?: boolean,\n  onCompleted?: Function,\n  onError?: Function,\n  eventKey?: any,\n};\n\nclass Login extends Component<Props> {\n  static defaultProps = {\n    scope: '',\n    fields: Fields,\n    returnScopes: false,\n    rerequest: false,\n    reauthorize: false,\n    onCompleted: undefined,\n    onError: undefined,\n    eventKey: undefined,\n  };\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n\n    const {\n      handleProcess, onCompleted, onError, onSuccess,\n    } = this.props;\n\n    try {\n      await handleProcess(async (api) => {\n        const {\n          scope, fields, returnScopes, rerequest, reauthorize, eventKey,\n        } = this.props;\n        const loginQpts = { scope };\n        const authType = [];\n\n        if (returnScopes) {\n          loginQpts.return_scopes = true;\n        }\n\n        if (rerequest) {\n          authType.push('rerequest');\n        }\n\n        if (reauthorize) {\n          authType.push('reauthenticate');\n        }\n\n        if (authType.length) {\n          loginQpts.auth_type = authType.join(',');\n        }\n\n        const loginResponse = await api.login(loginQpts);\n        if (loginResponse.status !== 'connected') {\n          throw new Error('Unauthorized user');\n        }\n\n        const data = await api.getTokenDetailWithProfile({ fields }, loginResponse);\n\n        if (onCompleted) {\n          await onCompleted({\n            ...data,\n            eventKey,\n          });\n        }\n\n        return data;\n      }, onSuccess);\n    } catch (error) {\n      if (onError) {\n        onError(error);\n      }\n    }\n  }\n\n  render() {\n    const {\n      children, loading, error, data,\n    } = this.props;\n\n    return children({\n      loading,\n      handleClick: this.handleClick,\n      error,\n      data,\n    });\n  }\n}\n\nexport default forwardRef((props, ref) => (\n  <Process>\n    {({\n      loading, handleProcess, data, error,\n    }) => (\n      <Login\n        {...props}\n        loading={loading}\n        handleProcess={handleProcess}\n        data={data}\n        error={error}\n        ref={ref}\n      />\n    )}\n  </Process>\n));\n"],"file":"Login.js"}