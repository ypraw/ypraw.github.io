{"version":3,"sources":["../src/Parser.jsx"],"names":["React","Component","InitFacebook","Parser","handleFacebookReady","facebook","parse","handleContainer","container","componentWillReceiveProps","props","oldChildren","children","changed","Object","keys","find","propName","oldValue","newValue","rerender","shouldComponentUpdate","forceUpdate","parsed","parseResponse","onParse","render","className","defaultProps","undefined"],"mappings":"AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,OAAOC,YAAP,MAAyB,gBAAzB;;AAQA,eAAe,MAAMC,MAAN,SAAqBF,SAArB,CAAsC;AAAA;AAAA;;AAAA,wCAqCnDG,mBArCmD,GAqC5BC,QAAD,IAAc;AAClC,WAAKA,QAAL,GAAgBA,QAAhB;AACA,WAAKC,KAAL;AACD,KAxCkD,OA0CnDC,eA1CmD,GA0ChCC,SAAD,IAAe;AAC/B,WAAKA,SAAL,GAAiBA,SAAjB;AACA,WAAKF,KAAL;AACD,KA7CkD;AAAA;;AAMnDG,4BAA0BC,KAA1B,EAAiC;AAC/B,UAAMC,cAAc,KAAKD,KAAL,CAAWE,QAA/B;AACA,UAAM,EAAEA,QAAF,KAAeF,KAArB;;AAEA,QAAI,CAACE,QAAD,IAAa,CAACD,WAAlB,EAA+B;AAC7B;AACD;;AAED,UAAME,UAAUC,OAAOC,IAAP,CAAYJ,YAAYD,KAAxB,EAA+BM,IAA/B,CAAqCC,QAAD,IAAc;AAChE,YAAMC,WAAWP,YAAYD,KAAZ,CAAkBO,QAAlB,CAAjB;AACA,YAAME,WAAWP,SAASF,KAAT,CAAeO,QAAf,CAAjB;;AAEA,aAAOC,aAAaC,QAApB;AACD,KALe,CAAhB;;AAOA,QAAIN,OAAJ,EAAa;AACX,WAAKO,QAAL;AACD;AACF;;AAEDC,0BAAwB;AACtB,WAAO,KAAP;AACD;;AAEDD,aAAW;AACT,SAAKE,WAAL;;AAEA,SAAKC,MAAL,GAAc,KAAd;AACA,SAAKjB,KAAL;AACD;;AAYDA,UAAQ;AACN,UAAM,EAAEiB,MAAF,EAAUf,SAAV,EAAqBH,QAArB,KAAkC,IAAxC;AACA,QAAIkB,UAAU,CAACf,SAAX,IAAwB,CAACH,QAA7B,EAAuC;AACrC,aAAO,KAAP;AACD;;AAED,SAAKkB,MAAL,GAAc,IAAd;;AAEA,UAAMC,gBAAgBnB,SAASC,KAAT,CAAeE,SAAf,CAAtB;;AAEA,UAAM,EAAEiB,OAAF,KAAc,KAAKf,KAAzB;AACA,QAAIe,OAAJ,EAAa;AACXA,cAAQD,aAAR;AACD;;AAED,WAAOA,aAAP;AACD;;AAEDE,WAAS;AACP,UAAM,EAAEC,SAAF,EAAaf,QAAb,KAA0B,KAAKF,KAArC;;AAEA,WACE;AAAC,kBAAD;AAAA,QAAc,SAAS,KAAKN,mBAA5B;AACE;AAAA;AAAA,UAAK,WAAWuB,SAAhB,EAA2B,KAAK,KAAKpB,eAArC;AACGK;AADH;AADF,KADF;AAOD;AA3EkD;AAAhCT,M,CACZyB,Y,GAAe;AACpBD,aAAWE,SADS;AAEpBJ,WAASI;AAFW,C","file":"Parser.js","sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport type { Node } from 'react';\nimport InitFacebook from './InitFacebook';\n\ntype Props = {\n  className?: string,\n  children?: Node,\n  onParse?: Function,\n};\n\nexport default class Parser extends Component<Props> {\n  static defaultProps = {\n    className: undefined,\n    onParse: undefined,\n  };\n\n  componentWillReceiveProps(props) {\n    const oldChildren = this.props.children;\n    const { children } = props;\n\n    if (!children || !oldChildren) {\n      return;\n    }\n\n    const changed = Object.keys(oldChildren.props).find((propName) => {\n      const oldValue = oldChildren.props[propName];\n      const newValue = children.props[propName];\n\n      return oldValue !== newValue;\n    });\n\n    if (changed) {\n      this.rerender();\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  rerender() {\n    this.forceUpdate();\n\n    this.parsed = false;\n    this.parse();\n  }\n\n  handleFacebookReady = (facebook) => {\n    this.facebook = facebook;\n    this.parse();\n  }\n\n  handleContainer = (container) => {\n    this.container = container;\n    this.parse();\n  }\n\n  parse() {\n    const { parsed, container, facebook } = this;\n    if (parsed || !container || !facebook) {\n      return false;\n    }\n\n    this.parsed = true;\n\n    const parseResponse = facebook.parse(container);\n\n    const { onParse } = this.props;\n    if (onParse) {\n      onParse(parseResponse);\n    }\n\n    return parseResponse;\n  }\n\n  render() {\n    const { className, children } = this.props;\n\n    return (\n      <InitFacebook onReady={this.handleFacebookReady}>\n        <div className={className} ref={this.handleContainer}>\n          {children}\n        </div>\n      </InitFacebook>\n    );\n  }\n}\n"]}