{"version":3,"sources":["../src/Login.jsx"],"names":["React","Component","forwardRef","Process","Fields","Login","evn","preventDefault","handleProcess","onCompleted","onError","onSuccess","props","api","scope","fields","returnScopes","rerequest","reauthorize","eventKey","loginQpts","authType","return_scopes","push","length","auth_type","join","loginResponse","login","status","Error","data","getTokenDetailWithProfile","error","render","children","loading","handleClick","undefined","ref"],"mappings":"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","sourcesContent":["// @flow\nimport React, { Component, forwardRef } from 'react';\nimport Process from './Process';\nimport Fields from './constants/Fields';\n\ntype Props = {\n  children: Function,\n  handleProcess: Function,\n  loading: boolean,\n  data: any,\n  error: Error,\n  scope?: string,\n  fields?: string[],\n  returnScopes?: boolean,\n  rerequest?: boolean,\n  reauthorize?: boolean,\n  onCompleted?: Function,\n  onError?: Function,\n  eventKey?: any,\n};\n\nclass Login extends Component<Props> {\n  static defaultProps = {\n    scope: '',\n    fields: Fields,\n    returnScopes: false,\n    rerequest: false,\n    reauthorize: false,\n    onCompleted: undefined,\n    onError: undefined,\n    eventKey: undefined,\n  };\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n\n    const {\n      handleProcess, onCompleted, onError, onSuccess,\n    } = this.props;\n\n    try {\n      await handleProcess(async (api) => {\n        const {\n          scope, fields, returnScopes, rerequest, reauthorize, eventKey,\n        } = this.props;\n        const loginQpts = { scope };\n        const authType = [];\n\n        if (returnScopes) {\n          loginQpts.return_scopes = true;\n        }\n\n        if (rerequest) {\n          authType.push('rerequest');\n        }\n\n        if (reauthorize) {\n          authType.push('reauthenticate');\n        }\n\n        if (authType.length) {\n          loginQpts.auth_type = authType.join(',');\n        }\n\n        const loginResponse = await api.login(loginQpts);\n        if (loginResponse.status !== 'connected') {\n          throw new Error('Unauthorized user');\n        }\n\n        const data = await api.getTokenDetailWithProfile({ fields }, loginResponse);\n\n        if (onCompleted) {\n          await onCompleted({\n            ...data,\n            eventKey,\n          });\n        }\n\n        return data;\n      }, onSuccess);\n    } catch (error) {\n      if (onError) {\n        onError(error);\n      }\n    }\n  }\n\n  render() {\n    const {\n      children, loading, error, data,\n    } = this.props;\n\n    return children({\n      loading,\n      handleClick: this.handleClick,\n      error,\n      data,\n    });\n  }\n}\n\nexport default forwardRef((props, ref) => (\n  <Process>\n    {({\n      loading, handleProcess, data, error,\n    }) => (\n      <Login\n        {...props}\n        loading={loading}\n        handleProcess={handleProcess}\n        data={data}\n        error={error}\n        ref={ref}\n      />\n    )}\n  </Process>\n));\n"],"file":"Login.js"}