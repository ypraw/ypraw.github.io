"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

const fs = require(`fs-extra`);

exports.onCreateNode = require(`./on-node-create`);
exports.setFieldsOnGraphQLNodeType = require(`./extend-node-type`);

exports.onPreExtractQueries =
/*#__PURE__*/
function () {
  var _ref = (0, _asyncToGenerator2.default)(function* ({
    store,
    getNodesByType
  }) {
    const program = store.getState().program; // Check if there are any ImageSharp nodes. If so add fragments for ImageSharp.
    // The fragment will cause an error if there are no ImageSharp nodes.

    if (getNodesByType(`ImageSharp`).length == 0) {
      return;
    } // We have ImageSharp nodes so let's add our fragments to .cache/fragments.


    yield fs.copy(require.resolve(`gatsby-transformer-sharp/src/fragments.js`), `${program.directory}/.cache/fragments/image-sharp-fragments.js`);
  });

  return function (_x) {
    return _ref.apply(this, arguments);
  };
}();